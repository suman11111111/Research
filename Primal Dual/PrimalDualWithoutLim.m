clear,clc;

theta=0.005;

N=1000;

PD=551.7546;

P1(1)=137.98;
P2(1)=287.98;
P3(1)=40;
P4(1)=20;
P5(1)=15;
P6(1)=17;

b1=2;
b2=1.75;
b3=1;
b4=3.25;
b5=3;
b6=3;

c1=0.00375;
c2=0.00175;
c3=0.0625;
c4=0.008324;
c5=0.025;
c6=0.025;

A=ones(1,6);


for i=1:N
    delf=[b1+2*c1*P1(i);b2+2*c2*P2(i);b3+2*c3*P3(i);b4+2*c4*P4(i);b5+2*c5*P5(i);b6+2*c6*P6(i)];
    del2f=diag([2*c1,2*c2,2*c3,2*c4,2*c5,2*c6]);
    S=inv([del2f A';A 0])*[-delf;PD-P1(i)-P2(i)-P3(i)-P4(i)-P5(i)-P6(i)];
    P1(i+1)=P1(i)+S(1);
    P2(i+1)=P2(i)+S(2);
    P3(i+1)=P3(i)+S(3);
    P4(i+1)=P4(i)+S(4);
    P5(i+1)=P5(i)+S(5);
    P6(i+1)=P6(i)+S(6);
end
